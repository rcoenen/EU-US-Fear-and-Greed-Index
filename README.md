# EU & US Fear & Greed Indices (Open Source)

## Motivation

In an era marked by significant geopolitical events and policy shifts, such as trade disputes and evolving global economic relationships, understanding the *relative* impact on major economies like the US and the EU is crucial. Market sentiment can be heavily influenced by these factors, often in divergent ways.

This project was initiated to develop a tool that allows for a direct, data-driven comparison of market sentiment (Fear vs. Greed) between the US and EU. By using consistent, open-source methodologies for both indices, we aim to provide insights into questions like:

*   How are specific events or policies perceived differently by US vs. EU markets?
*   Which economy's market sentiment appears more resilient or volatile in the face of global uncertainty?

This tool seeks to offer a clearer, comparative lens on market psychology beyond analyzing single-market indicators in isolation.

## Project Goal

This project implements comparable Fear & Greed Index calculations for both the European Union (EU) and United States (US) markets, relying exclusively on publicly available, open-source data (primarily via the `yfinance` library).

The primary goal is **not** to replicate proprietary indices like the one published by CNN, but rather to create a **consistent and comparable** set of sentiment indicators for the EU and US markets using transparent, open methodologies.

## EU vs US Comparability

A key focus of this project is ensuring the methodologies used for calculating the EU and US indices are as similar as possible given data availability constraints. This allows for a more meaningful **direct comparison** between the sentiment scores of the two regions. If the US index shows "Extreme Fear" (e.g., 25) and the EU index shows "Fear" (e.g., 37), you can have higher confidence that this reflects a genuine difference in sentiment drivers as captured by this specific model, rather than just differences in calculation techniques.

## Comparison to CNN Fear & Greed Index

It is important to understand that the scores generated by this project **will not** match the official CNN Fear & Greed Index. This discrepancy arises because:

1.  **Proprietary Data & Methodology:** CNN utilizes proprietary data sources (like specific options market data for Put/Call ratios) and calculation methods that are not publicly disclosed.
2.  **Indicator Differences:**
    *   **Put/Call Ratio:** This model currently lacks a reliable open-source equivalent for the CBOE Put/Call ratio used by CNN.
    *   **Volatility:** This model uses `^VIX` for the US (aligning with CNN's input) but relies on a calculated rolling volatility proxy (`VGK` ETF) for the EU, as a direct VSTOXX equivalent isn't readily available via `yfinance`. CNN uses VIX for its US index.
    *   **Breadth/Strength:** This model uses sample-based indicators (volume-weighted advancing/declining volume, stocks near highs/lows from a sample list), whereas CNN uses market-wide indicators (McClellan Volume Summation Index, NYSE New Highs-Lows).

Despite these differences, this project aims to capture the *spirit* of the Fear & Greed concept using the best available open-source proxies and calculations. The resulting EU and US scores provide a valuable *relative* measure of sentiment within this specific, consistent framework.

## Calculation Methodology

Both the EU and US indices are calculated by aggregating scores from several individual market indicators. Each indicator measures a different aspect of market sentiment or behavior.

1.  **Individual Indicators:** The project calculates scores for the following indicators (where applicable for EU/US):
    *   **Market Momentum:** Compares the main index (e.g., S&P 500, STOXX Europe 50) to its moving average.
    *   **Stock Strength:** Measures the number of stocks hitting 52-week highs versus lows within a defined sample.
    *   **Stock Breadth:** Compares the trading volume of advancing stocks versus declining stocks within a defined sample.
    *   **Volatility:** Measures market fear using volatility metrics (percentile rank of `^VIX` for US, percentile rank of calculated `VGK` rolling volatility for EU).
    *   **Safe Haven Demand:** Compares the performance of stocks versus treasury bonds.
    *   **Junk Bond Demand:** Compares the performance of high-yield (junk) bonds versus investment-grade corporate bonds.
2.  **Scoring:** Each indicator function calculates a score between 0 (indicating maximum Fear/Risk-Off) and 100 (indicating maximum Greed/Risk-On). Specific methods vary (e.g., deviation from average, percentile ranking, ratio analysis) but are normalized to this 0-100 scale.
3.  **Final Index:** The final Fear & Greed Index score for both EU and US is a simple average of the scores from their respective component indicators.

## How to Run

1.  **Setup Environment:**
    ```bash
    python -m venv venv
    source venv/bin/activate # On Windows use `venv\Scripts\activate`
    pip install -r requirements.txt
    ```
2.  **Run the Dashboard:**
    ```bash
    streamlit run dashboard.py
    ```
    Access the dashboard via the URL provided in your terminal.
3.  **Run Tests:**
    ```bash
    python test_harness.py
    ```

## Changelog (Recent Major Changes)

*   **Volatility Refactor (Percentile-Based):** Updated both EU and US volatility indicators to use percentile ranking against 1-year historical data. This provides more nuanced scores than the previous linear deviation method. US uses `^VIX` history; EU uses the history of calculated rolling volatility from the `VGK` proxy.
*   **Stock Breadth Refactor (Volume-Weighted):** Changed the stock breadth indicators (EU & US) to use the ratio of advancing volume vs declining volume, rather than just counting advancing/declining stocks.
*   **Error Handling:** Implemented stricter "fail-fast" error handling using `ValueError` exceptions in indicator modules if critical data is missing or calculations fail. The main index calculation now catches these errors.
*   **EU Volatility Proxy:** Initially used `FEZ` ETF as a proxy for VSTOXX, later switched to using `VGK` for calculating the EU volatility measure.
*   **Test Harness:** Added `test_harness.py` for command-line testing and validation of both index calculations.
*   **Streamlit UI:** Fixed duplicate key errors during dashboard animations by adding unique keys to `st.plotly_chart` elements. Implemented basic display of scores and gauges.


This README provides a high-level overview. For detailed calculation logic, please refer to the source code within the `eu_fear_greed_index` and `us_fear_greed_index` directories. 